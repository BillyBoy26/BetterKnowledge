<link rel="import" href="../bower_components/polymer/polymer.html">


<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-icons/hardware-icons.html">
<link rel="import" href="../bower_components/iron-list/iron-list.html">




<dom-module id="category-list">
    <template>
        <iron-list id="myIronList" items="{{categoryList}}" as="category" grid$="{{grid}}" selection-enabled >
            <template>
                <div>
                    <div class="categoryContent" tabindex$="[[tabIndex]]">
                        <paper-card heading="[[category.name]]" image="[[category.imagePath]]" class ="white imgManager" elevation="3">
                            <div class="card-content">
                                <div class="info">[[category.updateDate]]</div>
                            </div>
                            <div class ="card-actions">
                                <paper-button id="discuss" on-tap="launchDiscussion" >Discuss about it</paper-button>
                                <paper-icon-button icon="hardware:keyboard-arrow-up" title="more info" on-tap="toggle" style="float:right;">
                                </paper-icon-button>
                                <iron-collapse id="more-info" style="width:100%;">
                                    [[category.description]]
                                </iron-collapse>
                            </div>
                        </paper-card>
                    </div>
                </div>
            </template>
        </iron-list>
        <form is="iron-form" id="hiddenForm" action="/accueil/launchDiscussion"  method="post" enctype="text/plain">
            <input type="hidden"  id="categoryId" name="catId"/>
        </form>
    </template>

    <style>

        iron-list {
            --iron-list-items-container: {
                 max-width: 600px;
                 margin-top: 60px;
                 margin-bottom: 60px;
            };
        }


        paper-card{
            width: 300px;
        }

        :host{
            --iron-image-height: 229px;;
        }

        paper-card.white {
            --paper-card-header-color:#FFF;
        }

        .card-content{
            height:15px;
            overflow:hidden;
        }

        .info {
            font-style: italic;
            font-size: 14px;
            color: #696969;
        }

    </style>

    <script>

        Polymer({
            is: 'category-list',
            properties: {
                categoryList: Array,
                grid: Boolean
            },


            launchDiscussion: function(element){
                var hiddenForm = document.getElementById('hiddenForm');
                var categorySelected = element.model.category.id;
                document.getElementById('categoryId').setAttribute("value", categorySelected);
                hiddenForm.submit();
            },

            toggle: function(element) {
                var iconButton = Polymer.dom(event).localTarget;
                var moreInfo = iconButton.nextElementSibling;
                iconButton.icon = moreInfo.opened ? 'hardware:keyboard-arrow-up'
                        : 'hardware:keyboard-arrow-down';
                moreInfo.toggle();
         }

        });
    </script>

</dom-module>